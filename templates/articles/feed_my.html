{% extends "base.html" %}
{% block page_title %}My Articles{% endblock %}
{% load static %}

{% block content %}
<main style="padding: 30px 40px;">

  {% if articles %}
    <div style="
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(520px, 1fr));
      gap: 28px;
      justify-content: center;
    ">
      {% for a in articles %}
        <div style="
          background: white;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
          padding: 20px;
          display: flex;
          flex-direction: column;
          gap: 15px;
          transition: transform 0.2s, box-shadow 0.2s;
        ">

          {% if a.image %}
            <a href="{% url 'article_detail' a.pk %}">
              <img src="{{ a.image.url }}" alt="{{ a.title }}"
                   style="width:100%; height:200px; object-fit:cover; border-radius:8px;">
            </a>
          {% endif %}

          <div>
            <h3 style="margin:10px 0 6px; font-size:20px;">
              <a href="{% url 'article_detail' a.pk %}" style="color:#1f2937; text-decoration:none;">
                {{ a.title }}
              </a>
            </h3>

            <div style="font-size:14px; color:#6b7280; margin-bottom:8px;
                        display:flex; flex-wrap:wrap; gap:12px; align-items:center;">
              <span>ğŸ·ï¸ {{ a.category.name }}</span>
              <span>â­ {{ a.rating_percent|default:"0.0" }}%</span>
              <span>ğŸ“… {{ a.created_at|date:"M d, Y" }}</span>
              {% if not a.is_published %}
                <span style="color:#dc2626;">â³ Awaiting moderation</span>
              {% else %}
                <span style="color:#16a34a;">âœ… Published</span>
              {% endif %}
            </div>

            <p style="
              font-size:15px; color:#374151; line-height:1.6;
              margin:0 0 12px; overflow:hidden;
              display:-webkit-box; -webkit-line-clamp:3;
              -webkit-box-orient:vertical; text-overflow:ellipsis;">
              {{ a.content }}
            </p>

            <div style="display:flex; justify-content:space-between; align-items:center;">
              <a href="{% url 'article_detail' a.pk %}"
                 style="background:#2563eb; color:white; text-decoration:none;
                        padding:8px 14px; border-radius:6px; font-weight:600;">
                Read more
              </a>

              <div style="display:flex; gap:8px;">
                <a href="{% url 'article_update' a.pk %}"
                   style="background:#fbbf24; color:white; text-decoration:none;
                          padding:8px 14px; border-radius:6px; font-weight:600;">
                  Edit
                </a>

                <form method="post" action="{% url 'article_delete' a.pk %}">
                  {% csrf_token %}
                  <button type="submit"
                          style="background:#ef4444; color:white; border:none;
                                 padding:8px 14px; border-radius:6px;
                                 font-weight:600; cursor:pointer;">
                    ğŸ—‘ Delete
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p style="text-align:center; color:#6b7280; font-size:15px;">
      You havenâ€™t created any articles yet.
    </p>
  {% endif %}
</main>
{% endblock %}
